/*! Flora v2.2.6 - 2014-05-24 05:05:58 
Vince Allen |Brooklyn, NY | vince@vinceallen.com | @vinceallenvince | License: MIT */
!function(a,b){function c(a){this._borders=[],this.id=a||c._idCount,c._idCount++}function d(a){this._gradients=[],this._colors=[],this.id=a||d._idCount,d._idCount++}function e(){}function f(a){var b,c,d,e=a||{};for(this.world=e.world||Burner.System.firstWorld(),this.position=e.position||"top left",this.text=e.text||"",this.opacity="undefined"==typeof e.opacity?.75:e.opacity,this.color=e.color||[255,255,255],this.borderWidth=e.borderWidth||0,this.borderStyle=e.borderStyle||"none",this.borderColor=e.borderColor||[204,204,204],this.colorMode="rgb",this.el=document.createElement("div"),this.el.id="caption",this.el.className="caption ",d=this.position.split(" "),b=0,c=d.length;c>b;b++)this.el.className=this.el.className+"caption"+z.capitalizeFirstLetter(d[b])+" ";this.el.style.opacity=this.opacity,this.el.style.color=this.colorMode+"("+this.color[0]+", "+this.color[1]+", "+this.color[2]+")",this.el.style.borderWidth=this.borderWidth+"px",this.el.style.borderStyle=this.borderStyle,this.el.style.borderColor="string"==typeof this.borderColor?this.borderColor:this.colorMode+"("+this.borderColor[0]+", "+this.borderColor[1]+", "+this.borderColor[2]+")",this.el.zIndex=100,this.el.appendChild(document.createTextNode(this.text)),document.getElementById("caption")&&document.getElementById("caption").parentNode.removeChild(document.getElementById("caption")),this.world.el.appendChild(this.el)}function g(a){var b,c,d,e=this,f=a||{};for(this.name="InputMenu",this.world=f.world||Burner.System.firstWorld(),this.position=f.position||"top left",this.opacity="undefined"==typeof f.opacity?.75:f.opacity,this.color=f.color||[255,255,255],this.borderWidth=f.borderWidth||0,this.borderStyle=f.borderStyle||"none",this.borderColor=f.borderColor||[204,204,204],this.colorMode="rgb",this.text=Burner.System.supportedFeatures.touch?x.touchMap.stats+"-finger tap = stats | "+x.touchMap.pause+"-finger tap = pause | "+x.touchMap.reset+"-finger tap = reset":"'"+String.fromCharCode(x.keyMap.pause).toLowerCase()+"' = pause | "+"'"+String.fromCharCode(x.keyMap.resetSystem).toLowerCase()+"' = reset | "+"'"+String.fromCharCode(x.keyMap.stats).toLowerCase()+"' = stats",this.el=document.createElement("div"),this.el.id="inputMenu",this.el.className="inputMenu ",d=this.position.split(" "),b=0,c=d.length;c>b;b++)this.el.className=this.el.className+"inputMenu"+z.capitalizeFirstLetter(d[b])+" ";this.el.style.opacity=this.opacity,this.el.style.color=this.colorMode+"("+this.color[0]+", "+this.color[1]+", "+this.color[2]+")",this.el.style.borderWidth=this.borderWidth+"px",this.el.style.borderStyle=this.borderStyle,this.el.style.borderColor="string"==typeof this.borderColor?this.borderColor:this.colorMode+"("+this.borderColor[0]+", "+this.borderColor[1]+", "+this.borderColor[2]+")",this.el.appendChild(document.createTextNode(this.text)),document.getElementById("inputMenu")&&document.getElementById("inputMenu").parentNode.removeChild(document.getElementById("inputMenu")),Burner.System.supportedFeatures.touch?z.addEvent(this.el,"touchstart",function(){e.destroy()}):z.addEvent(this.el,"mouseup",function(){e.destroy()}),this.world.el.appendChild(this.el)}function h(a){var b=a||{};b.name=b.name||"Mover",Burner.Item.call(this,b)}function i(a){var b=a||{};b.name=b.name||"Agent",h.call(this,b)}function j(a){var b=a||{};b.name=b.name||"Walker",h.call(this,b)}function k(a){var b=a||{};if(!b||!b.type)throw new Error("Stimulus: options.type is required.");b.name=b.name||"Sensor",h.call(this,b)}function l(a){var b=a||{};b.name=b.name||"Connector",Burner.Item.call(this,b)}function m(a){var b=a||{};b.name=b.name||"Point",Burner.Item.call(this,b)}function n(a){var b=a||{};b.name=b.name||"Particle",h.call(this,b)}function o(a){var b=a||{};b.name=b.name||"ParticleSystem",h.call(this,b)}function p(a){var b=a||{};b.name=b.name||"Oscillator",h.call(this,b)}function q(a){var b=a||{};b.name=b.name||"Dragger",i.call(this,b)}function r(a){var b=a||{};b.name=b.name||"Attractor",h.call(this,b)}function s(a){var b=a||{};b.name=b.name||"Repeller",h.call(this,b)}function t(a){if(!a||!a.type)throw new Error("Stimulus: options.type is required.");a.name=a.name||a.type,h.call(this,a)}function u(a){var b=a||{};b.name=b.name||"FlowField",Burner.Item.call(this,b)}function v(a){var b,c,d={location:"object",scale:"number",angle:"number",opacity:"number",width:"number",height:"number",colorMode:"string",color:"array"};return y.checkRequiredParams(a,d)?(b=document.createElement("div"),c=document.createElement("div"),b.className="flowFieldMarker item",c.className="nose",b.appendChild(c),b.style.cssText=Burner.System.getCSSText({x:a.location.x-a.width/2,y:a.location.y-a.height/2,width:a.width,height:a.height,opacity:a.opacity,angle:a.angle,scale:1,colorMode:a.colorMode,color0:a.color[0],color1:a.color[1],color2:a.color[2],zIndex:a.zIndex,borderRadius:a.borderRadius}),b):void 0}function w(a){var b=a||{};b.name=b.name||"RangeDisplay",Burner.Item.call(this,b)}b.Flora=a,Burner.Classes=Flora;var x={borderStyles:["none","solid","dotted","dashed","double","inset","outset","groove","ridge"],defaultColorList:[{name:"cold",startColor:[88,129,135],endColor:[171,244,255],boxShadowColor:[132,192,201]},{name:"food",startColor:[186,255,130],endColor:[84,187,0],boxShadowColor:[57,128,0]},{name:"heat",startColor:[255,132,86],endColor:[175,47,0],boxShadowColor:[255,69,0]},{name:"light",startColor:[255,255,255],endColor:[189,148,0],boxShadowColor:[255,200,0]},{name:"oxygen",startColor:[130,136,255],endColor:[49,56,205],boxShadowColor:[60,64,140]}],keyMap:{pause:80,resetSystem:82,stats:83},touchMap:{stats:2,pause:3,reset:4}},y={};y.checkRequiredParams=function(a,b,c){var d,e,f=!0;for(d in b)if(b.hasOwnProperty(d))try{if("undefined"==typeof a)throw new Error("checkRequiredOptions: No options were passed.");if(!this.checkDataType(this.getDataType(a[d]),b[d].split("|"))||""===a[d])throw f=!1,e=""===a[d]?'checkRequiredOptions: required option "'+d+'" is empty.':"undefined"==typeof a[d]?'checkRequiredOptions: required option "'+d+'" is missing from passed options.':'checkRequiredOptions: passed option "'+d+'" must be type '+b[d]+". Passed as "+this.getDataType(a[d])+".",new Error(e)}catch(g){"undefined"!=typeof console&&console.log("ERROR: "+g.message+(c?" from: "+c:""))}return f},y.checkDataType=function(a,b){var c,d;for(c=0,d=b.length;d>c;c++)if(a===b[c])return!0;return!1},y.getDataType=function(a){return"[object Array]"===Object.prototype.toString.call(a)?"array":"[object NodeList]"===Object.prototype.toString.call(a)?"nodeList":typeof a};var z={};z.extend=function(a,b){function c(){}c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a,a._superClass=b},z.map=function(a,b,c,d,e){var f=(a-b)/(c-b);return f*(e-d)+d},z.getRandomNumber=function(a,b,c){return c?Math.random()*(b-(a-1))+a:Math.floor(Math.random()*(b-(a-1)))+a},z.degreesToRadians=function(a){return"undefined"!=typeof a?2*Math.PI*(a/360):("undefined"!=typeof console&&console.log("Error: Utils.degreesToRadians is missing degrees param."),!1)},z.radiansToDegrees=function(a){return"undefined"!=typeof a?a*(180/Math.PI):("undefined"!=typeof console&&console.log("Error: Utils.radiansToDegrees is missing radians param."),!1)},z.constrain=function(a,b,c){return a>c?c:b>a?b:a},z.clone=function(a){function b(){}return b.prototype=a,new b},z.addEvent=function(a,b,c){a.addEventListener?this.addEventHandler=function(a,b,c){a.addEventListener(b,c,!1)}:a.attachEvent&&(this.addEventHandler=function(a,b,c){a.attachEvent("on"+b,c)}),this.addEventHandler(a,b,c)},z.log=function(a){"undefined"!=typeof console&&"undefined"!=typeof console.log?(this.log=function(a){console.log(a)},this.log.call(this,a)):this.log=function(){}},z.getWindowSize=function(){var a={width:!1,height:!1};return"undefined"!=typeof window.innerWidth?a.width=window.innerWidth:"undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientWidth?a.width=document.documentElement.clientWidth:"undefined"!=typeof document.body&&(a.width=document.body.clientWidth),"undefined"!=typeof window.innerHeight?a.height=window.innerHeight:"undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientHeight?a.height=document.documentElement.clientHeight:"undefined"!=typeof document.body&&(a.height=document.body.clientHeight),a},z.getDataType=function(a){return"[object Array]"===Object.prototype.toString.call(a)?"array":"[object NodeList]"===Object.prototype.toString.call(a)?"nodeList":typeof a},z.capitalizeFirstLetter=function(a){return a.charAt(0).toUpperCase()+a.slice(1)},z.isInside=function(a,b){return b&&a.location.x+a.width/2>b.location.x-b.width/2&&a.location.x-a.width/2<b.location.x+b.width/2&&a.location.y+a.height/2>b.location.y-b.height/2&&a.location.y-a.height/2<b.location.y+b.height/2?!0:!1},z.mouseIsInsideWorld=function(a){var b=Burner.System.mouse,c=b.location.x,d=b.location.y,e=a.el.offsetLeft,f=a.el.offsetTop;return a&&c>e&&c<e+a.bounds[1]&&d>f&&d<f+a.bounds[2]?!0:!1};var A=function(a){"undefined"==typeof a&&(a=Math);var b,c=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],d=[];for(b=0;256>b;b+=1)d[b]=Math.floor(256*a.random());var e=[];for(b=0;512>b;b+=1)e[b]=d[255&b];var f=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]];return{grad3:c,p:d,perm:e,simplex:f,dot:function(a,b,c){return a[0]*b+a[1]*c},noise:function(a,b){var c,d,e,f,g,h=.5*(Math.sqrt(3)-1),i=(a+b)*h,j=Math.floor(a+i),k=Math.floor(b+i),l=(3-Math.sqrt(3))/6,m=(j+k)*l,n=j-m,o=k-m,p=a-n,q=b-o;p>q?(f=1,g=0):(f=0,g=1);var r=p-f+l,s=q-g+l,t=p-1+2*l,u=q-1+2*l,v=255&j,w=255&k,x=this.perm[v+this.perm[w]]%12,y=this.perm[v+f+this.perm[w+g]]%12,z=this.perm[v+1+this.perm[w+1]]%12,A=.5-p*p-q*q;0>A?c=0:(A*=A,c=A*A*this.dot(this.grad3[x],p,q));var B=.5-r*r-s*s;0>B?d=0:(B*=B,d=B*B*this.dot(this.grad3[y],r,s));var C=.5-t*t-u*u;return 0>C?e=0:(C*=C,e=C*C*this.dot(this.grad3[z],t,u)),70*(c+d+e)},noise3d:function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n=1/3,o=(a+b+c)*n,p=Math.floor(a+o),q=Math.floor(b+o),r=Math.floor(c+o),s=1/6,t=(p+q+r)*s,u=p-t,v=q-t,w=r-t,x=a-u,y=b-v,z=c-w;x>=y?y>=z?(h=1,i=0,j=0,k=1,l=1,m=0):x>=z?(h=1,i=0,j=0,k=1,l=0,m=1):(h=0,i=0,j=1,k=1,l=0,m=1):z>y?(h=0,i=0,j=1,k=0,l=1,m=1):z>x?(h=0,i=1,j=0,k=0,l=1,m=1):(h=0,i=1,j=0,k=1,l=1,m=0);var A=x-h+s,B=y-i+s,C=z-j+s,D=x-k+2*s,E=y-l+2*s,F=z-m+2*s,G=x-1+3*s,H=y-1+3*s,I=z-1+3*s,J=255&p,K=255&q,L=255&r,M=this.perm[J+this.perm[K+this.perm[L]]]%12,N=this.perm[J+h+this.perm[K+i+this.perm[L+j]]]%12,O=this.perm[J+k+this.perm[K+l+this.perm[L+m]]]%12,P=this.perm[J+1+this.perm[K+1+this.perm[L+1]]]%12,Q=.6-x*x-y*y-z*z;0>Q?d=0:(Q*=Q,d=Q*Q*this.dot(this.grad3[M],x,y,z));var R=.6-A*A-B*B-C*C;0>R?e=0:(R*=R,e=R*R*this.dot(this.grad3[N],A,B,C));var S=.6-D*D-E*E-F*F;0>S?f=0:(S*=S,f=S*S*this.dot(this.grad3[O],D,E,F));var T=.6-G*G-H*H-I*I;return 0>T?g=0:(T*=T,g=T*T*this.dot(this.grad3[P],G,H,I)),32*(d+e+f+g)}}}({random:function(){return.1}});c._idCount=0,c.prototype.name="BorderPalette",c.prototype.addBorder=function(a){var b,c,d={min:"number",max:"number",style:"string"};if(y.checkRequiredParams(a,d))for(c=z.getRandomNumber(a.min,a.max),b=0;c>b;b++)this._borders.push(a.style);return this},c.prototype.getBorder=function(){if(this._borders.length>0)return this._borders[z.getRandomNumber(0,this._borders.length-1)];throw new Error("BorderPalette.getBorder: You must add borders via addBorder() before using getBorder().")},d._idCount=0,d.prototype.name="ColorPalette",d.prototype.addColor=function(a){var b,c,e,f={min:"number",max:"number",startColor:"array",endColor:"array"};if(y.checkRequiredParams(a,f))for(c=z.getRandomNumber(a.min,a.max),e=d._createColorRange(a.startColor,a.endColor,255),b=0;c>b;b++)this._colors.push(e[z.getRandomNumber(0,e.length-1)]);return this},d.prototype.createGradient=function(a){var b={startColor:"array",endColor:"array"};if(y.checkRequiredParams(a,b)){if(this.startColor=a.startColor,this.endColor=a.endColor,this.totalColors=a.totalColors||255,!(this.totalColors>0))throw new Error("ColorPalette: total colors must be greater than zero.");this._gradients.push(d._createColorRange(this.startColor,this.endColor,this.totalColors))}},d.prototype.getColor=function(){if(this._colors.length>0)return this._colors[z.getRandomNumber(0,this._colors.length-1)];throw new Error("ColorPalette.getColor: You must add colors via addColor() before using getColor().")},d.prototype.createSampleStrip=function(a){var b,c,d;for(b=0,c=this._colors.length;c>b;b++)d=document.createElement("div"),d.className="color-sample-strip",d.style.background="rgb("+this._colors[b].toString()+")",a.appendChild(d)},d._createColorRange=function(a,b,c){var d,e,f,g,h,i,j,k=[],l=a[0],m=a[1],n=a[2],o=b[0],p=b[1],q=b[2];for(e=o-l,f=p-m,g=q-n,d=0;c>d;d++)h=parseInt(e*d/c,10)+l,i=parseInt(f*d/c,10)+m,j=parseInt(g*d/c,10)+n,k.push([h,i,j]);return k},e.prototype.addColor=function(a){var b={name:"string",startColor:"array",endColor:"array"};return y.checkRequiredParams(a,b)&&(this[a.name]={startColor:a.startColor,endColor:a.endColor}),this},e.prototype.name="ColorTable",e.prototype.getColor=function(a,b,c){var d,e,f;if("string"!==y.getDataType(a))throw new Error("ColorTable: You must pass a name (string) for the color entry in the table.");if(!this[a])throw new Error("ColorTable: "+a+" does not exist. Add colors to the ColorTable via addColor().");return d=this[a],b&&(e=d.startColor),c&&(f=d.endColor),e&&f||!e&&!f?{startColor:d.startColor,endColor:d.endColor}:e?e:f?f:void 0},f.prototype.name="Caption",f.prototype.reset=function(){},f.prototype.init=function(){},f.prototype.update=function(a){this.el.textContent=a},f.prototype.destroy=function(){var a=this.el.id;return this.el.parentNode.removeChild(this.el),document.getElementById(a)?void 0:!0},g.prototype.name="InputMenu",g.prototype.reset=function(){},g.prototype.init=function(){},g.prototype.destroy=function(){var a=this.el.id;return this.el.parentNode.removeChild(this.el),document.getElementById(a)?void 0:!0},z.extend(h,Burner.Item),h.prototype.init=function(a){this.color=a.color||[255,255,255],this.pointToDirection="undefined"==typeof a.pointToDirection?!0:a.pointToDirection,this.draggable=!!a.draggable,this.parent=a.parent||null,this.pointToParentDirection=!!a.pointToParentDirection,this.offsetDistance="undefined"==typeof a.offsetDistance?30:a.offsetDistance,this.offsetAngle=a.offsetAngle||0,this.beforeStep=a.beforeStep||null,this.afterStep=a.afterStep||null,this.isMouseOut=!1,this.isPressed=!1;var b=function(a){return function(b){a.mouseover(b,a)}}(this),c=function(a){return function(b){a.mousedown(b,a)}}(this),d=function(a){return function(b){a.mousemove(b,a)}}(this),e=function(a){return function(b){a.mouseup(b,a)}}(this),f=function(a){return function(b){a.mouseout(b,a)}}(this);this.draggable&&(z.addEvent(this.el,"mouseover",b),z.addEvent(this.el,"mousedown",c),z.addEvent(this.el,"mousemove",d),z.addEvent(this.el,"mouseup",e),z.addEvent(this.el,"mouseout",f))},h.prototype.mouseover=function(){this.isMouseOut=!1,clearInterval(this.mouseOutInterval)},h.prototype.mousedown=function(a){var b,c=a.target||a.srcElement;a.changedTouches&&(b=a.changedTouches[0]),a.pageX&&a.pageY?(this.offsetX=a.pageX-c.offsetLeft,this.offsetY=a.pageY-c.offsetTop):a.clientX&&a.clientY?(this.offsetX=a.clientX-c.offsetLeft,this.offsetY=a.clientY-c.offsetTop):b&&(this.offsetX=b.pageX-c.offsetLeft,this.offsetY=b.pageY-c.offsetTop),this.isPressed=!0,this.isMouseOut=!1},h.prototype.mousemove=function(a){var b,c,d;this.isPressed&&(this.isMouseOut=!1,a.changedTouches&&(d=a.changedTouches[0]),a.pageX&&a.pageY?(b=a.pageX-this.world.el.offsetLeft,c=a.pageY-this.world.el.offsetTop):a.clientX&&a.clientY?(b=a.clientX-this.world.el.offsetLeft,c=a.clientY-this.world.el.offsetTop):d&&(b=d.pageX-this.world.el.offsetLeft,c=d.pageY-this.world.el.offsetTop),z.mouseIsInsideWorld(this.world)?this.location=new Burner.Vector(b,c):this.isPressed=!1)},h.prototype.mouseup=function(){this.isPressed=!1},h.prototype.mouseout=function(a,b){var c,d,e=b,f=Burner.System.mouse;b.isPressed&&(b.isMouseOut=!0,b.mouseOutInterval=setInterval(function(){e.isPressed&&e.isMouseOut&&(c=f.location.x-e.world.el.offsetLeft,d=f.location.y-e.world.el.offsetTop,e.location=new Burner.Vector(c,d))},16))},h.prototype.step=function(){var a,b,c,d,e,f,g,h=Burner.System._caches.Attractor,i=Burner.System._caches.Repeller,j=Burner.System._caches.Dragger;if(this.beforeStep&&this.beforeStep.apply(this),!this.isStatic&&!this.isPressed){if(this.world.c&&(a=z.clone(this.velocity),a.mult(-1),a.normalize(),a.mult(this.world.c),this.applyForce(a)),this.applyForce(this.world.gravity),h&&h.list.length>0)for(f=0,g=h.list.length;g>f;f+=1)this.id!==h.list[f].id&&this.applyForce(h.list[f].attract(this));if(i&&i.list.length>0)for(f=0,g=i.list.length;g>f;f+=1)this.id!==i.list[f].id&&this.applyForce(i.list[f].attract(this));if(j&&j.list.length>0)for(f=0,g=j.list.length;g>f;f+=1)this.id!==j.list[f].id&&z.isInside(this,j.list[f])&&this.applyForce(j.list[f].drag(this));this.applyAdditionalForces&&this.applyAdditionalForces(),this.velocity.add(this.acceleration),this.velocity.limit(this.maxSpeed,this.minSpeed),this.location.add(this.velocity),this.pointToDirection&&this.velocity.mag()>.1&&(this.angle=z.radiansToDegrees(Math.atan2(this.velocity.y,this.velocity.x)))}this.controlCamera&&this._checkCameraEdges(),this.checkWorldEdges&&this._checkWorldEdges(),this.parent&&(this.offsetDistance?(b=this.offsetDistance,c=z.degreesToRadians(this.parent.angle+this.offsetAngle),d=b*Math.cos(c),e=b*Math.sin(c),this.location.x=this.parent.location.x,this.location.y=this.parent.location.y,this.location.add(new Burner.Vector(d,e)),this.pointToParentDirection&&(this.angle=z.radiansToDegrees(Math.atan2(this.parent.velocity.y,this.parent.velocity.x)))):this.location=this.parent.location),this.acceleration.mult(0),this.life<this.lifespan?this.life+=1:-1!==this.lifespan&&Burner.System.destroyItem(this),this.afterStep&&this.afterStep.apply(this)},h.prototype._checkAvoidEdges=function(){var a,b;this.location.x<this.avoidWorldEdgesStrength?a=this.maxSpeed:this.location.x>this.world.bounds[1]-this.avoidWorldEdgesStrength&&(a=-this.maxSpeed),a&&(b=new Burner.Vector(a,this.velocity.y),b.sub(this.velocity),b.limit(this.maxSteeringForce),this.applyForce(b)),this.location.y<this.avoidWorldEdgesStrength?a=this.maxSpeed:this.location.y>this.world.bounds[2]-this.avoidWorldEdgesStrength&&(a=-this.maxSpeed),a&&(b=new Burner.Vector(this.velocity.x,a),b.sub(this.velocity),b.limit(this.maxSteeringForce),this.applyForce(b))},z.extend(i,h),i.prototype.init=function(a){var b,c,d=a||{};for(i._superClass.prototype.init.call(this,d),this.followMouse=!!d.followMouse,this.maxSteeringForce="undefined"==typeof d.maxSteeringForce?5:d.maxSteeringForce,this.seekTarget=d.seekTarget||null,this.flocking=!!d.flocking,this.desiredSeparation="undefined"==typeof d.desiredSeparation?2*this.width:d.desiredSeparation,this.separateStrength="undefined"==typeof d.separateStrength?.3:d.separateStrength,this.alignStrength="undefined"==typeof d.alignStrength?.2:d.alignStrength,this.cohesionStrength="undefined"==typeof d.cohesionStrength?.1:d.cohesionStrength,this.flowField=d.flowField||null,this.sensors=d.sensors||[],b=0,c=this.sensors.length;c>b;b++)this.sensors[b].parent=this;this.motorSpeed=d.motorSpeed||0,this.velocity.mag()||(this.velocity.x=1,this.velocity.y=0,this.velocity.normalize(),this.velocity.rotate(Flora.Utils.degreesToRadians(this.angle)),this.velocity.mult(this.motorSpeed)),this.color=d.color||[197,177,115],this.borderWidth=d.borderWidth||0,this.borderStyle=d.borderStyle||"none",this.borderColor=d.borderColor||"transparent",this.borderRadius=d.borderRadius||this.sensors.length?100:0,this.separateSumForceVector=new Burner.Vector,this.alignSumForceVector=new Burner.Vector,this.cohesionSumForceVector=new Burner.Vector,this.followTargetVector=new Burner.Vector,this.followDesiredVelocity=new Burner.Vector,this.motorDir=new Burner.Vector,Burner.System.updateCache(this)},i.prototype.applyAdditionalForces=function(){var a,b,c,d,e,f,g,h;if(this.sensors.length>0)for(a=0,b=this.sensors.length;b>a;a+=1)d=this.sensors[a],e=d.offsetDistance,f=z.degreesToRadians(this.angle+d.offsetAngle),g=e*Math.cos(f),h=e*Math.sin(f),d.location.x=this.location.x,d.location.y=this.location.y,d.location.add(new Burner.Vector(g,h)),a&&(d.borderStyle="none"),d.activated&&("function"==typeof d.behavior?this.applyForce(d.behavior.call(this,d,d.target)):this.applyForce(d.getBehavior().call(this,d,d.target)),c=!0);if(!c&&this.motorSpeed&&(this.motorDir.x=this.velocity.x,this.motorDir.y=this.velocity.y,this.motorDir.normalize(),this.velocity.mag()>this.motorSpeed?this.motorDir.mult(-this.motorSpeed):this.motorDir.mult(this.motorSpeed),this.applyForce(this.motorDir)),this.followMouse&&!Burner.System.supportedFeatures.touch){var i={location:new Burner.Vector(Burner.System.mouse.location.x,Burner.System.mouse.location.y)};this.applyForce(this._seek(i))}if(this.seekTarget&&this.applyForce(this._seek(this.seekTarget)),this.flowField){var j,k,l=this.flowField.resolution,m=Math.floor(this.location.x/l),n=Math.floor(this.location.y/l);this.flowField.field[m]&&(j=this.flowField.field[m][n],j?(this.followTargetVector.x=j.x,this.followTargetVector.y=j.y):(this.followTargetVector.x=this.location.x,this.followTargetVector.y=this.location.y),k={location:this.followTargetVector},this.applyForce(this.follow(k)))}return this.flocking&&this.flock(Burner.System.getAllItemsByName(this.name)),this.avoidWorldEdges&&this._checkAvoidEdges(),this.acceleration},i.prototype._seek=function(a){var b=this.world,c=Burner.Vector.VectorSub(a.location,this.location),d=c.mag();if(c.normalize(),d<b.bounds[1]/2){var e=z.map(d,0,b.bounds[1]/2,0,this.maxSpeed);c.mult(e)}else c.mult(this.maxSpeed);return c.sub(this.velocity),c.limit(this.maxSteeringForce),c},i.prototype.follow=function(a){return this.followDesiredVelocity.x=a.location.x,this.followDesiredVelocity.y=a.location.y,this.followDesiredVelocity.mult(this.maxSpeed),this.followDesiredVelocity.sub(this.velocity),this.followDesiredVelocity.limit(this.maxSteeringForce),this.followDesiredVelocity},i.prototype.flock=function(a){return this.applyForce(this.separate(a).mult(this.separateStrength)),this.applyForce(this.align(a).mult(this.alignStrength)),this.applyForce(this.cohesion(a).mult(this.cohesionStrength)),this.acceleration},i.prototype.separate=function(a){var b,c,d,e,f,g,h=0;for(this.separateSumForceVector.x=0,this.separateSumForceVector.y=0,g=this.separateSumForceVector,b=0,c=a.length;c>b;b+=1)d=a[b],this.className===d.className&&this.id!==d.id&&(f=this.location.distance(d.location),f>0&&f<this.desiredSeparation&&(e=Burner.Vector.VectorSub(this.location,d.location),e.normalize(),e.div(f),g.add(e),h+=1));return h>0?(g.div(h),g.normalize(),g.mult(this.maxSpeed),g.sub(this.velocity),g.limit(this.maxSteeringForce),g):new Burner.Vector},i.prototype.align=function(a){var b,c,d,e,f,g=2*this.width,h=0;for(this.alignSumForceVector.x=0,this.alignSumForceVector.y=0,f=this.alignSumForceVector,b=0,c=a.length;c>b;b+=1)d=a[b],e=this.location.distance(d.location),e>0&&g>e&&this.className===d.className&&this.id!==d.id&&(f.add(d.velocity),h+=1);return h>0?(f.div(h),f.normalize(),f.mult(this.maxSpeed),f.sub(this.velocity),f.limit(this.maxSteeringForce),f):new Burner.Vector},i.prototype.cohesion=function(a){var b,c,d,e,f,g=10,h=0;for(this.cohesionSumForceVector.x=0,this.cohesionSumForceVector.y=0,f=this.cohesionSumForceVector,b=0,c=a.length;c>b;b+=1)d=a[b],e=this.location.distance(d.location),e>0&&g>e&&this.className===d.className&&this.id!==d.id&&(f.add(d.location),h+=1);return h>0?(f.div(h),f.sub(this.location),f.normalize(),f.mult(this.maxSpeed),f.sub(this.velocity),f.limit(this.maxSteeringForce),f):new Burner.Vector},i.prototype.getLocation=function(a){return a?"x"===a?this.location.x:"y"===a?this.location.y:void 0:new Burner.Vector(this.location.x,this.location.y)},i.prototype.getVelocity=function(a){return a?"x"===a?this.velocity.x:"y"===a?this.velocity.y:void 0:new Burner.Vector(this.location.x,this.location.y)},z.extend(j,h),j.prototype.init=function(a){var b=a||{};this.width="undefined"==typeof b.width?10:b.width,this.height="undefined"==typeof b.height?10:b.height,this.perlin="undefined"==typeof b.perlin?!0:b.perlin,this.remainsOnScreen=!!b.remainsOnScreen,this.perlinSpeed="undefined"==typeof b.perlinSpeed?.005:b.perlinSpeed,this.perlinTime=b.perlinTime||0,this.perlinAccelLow="undefined"==typeof b.perlinAccelLow?-.075:b.perlinAccelLow,this.perlinAccelHigh="undefined"==typeof b.perlinAccelHigh?.075:b.perlinAccelHigh,this.offsetX="undefined"==typeof b.offsetX?1e4*Math.random():b.offsetX,this.offsetY="undefined"==typeof b.offsetY?1e4*Math.random():b.offsetY,this.color=b.color||[255,150,50],this.borderWidth="undefined"==typeof b.borderWidth?2:b.borderWidth,this.borderStyle=b.borderStyle||"solid",this.borderColor=b.borderColor||[255,255,255],this.borderRadius="undefined"==typeof b.borderRadius?100:b.borderRadius,this._randomVector=new Burner.Vector},j.prototype.applyAdditionalForces=function(){this.perlin?(this.perlinTime+=this.perlinSpeed,this.remainsOnScreen?(this.acceleration=new Burner.Vector,this.velocity=new Burner.Vector,this.location.x=z.map(A.noise(this.perlinTime+this.offsetX,0,.1),-1,1,0,this.world.bounds[1]),this.location.y=z.map(A.noise(0,this.perlinTime+this.offsetY,.1),-1,1,0,this.world.bounds[2])):(this.acceleration.x=z.map(A.noise(this.perlinTime+this.offsetX,0,.1),-1,1,this.perlinAccelLow,this.perlinAccelHigh),this.acceleration.y=z.map(A.noise(0,this.perlinTime+this.offsetY,.1),-1,1,this.perlinAccelLow,this.perlinAccelHigh))):(this._randomVector.x=1,this._randomVector.y=1,this._randomVector.normalize(),this._randomVector.rotate(z.degreesToRadians(z.getRandomNumber(0,359))),this._randomVector.mult(this.maxSpeed),this.applyForce(this._randomVector))},z.extend(k,h),k.prototype.init=function(a){var b=a||{};k._superClass.prototype.init.call(this,b),this.type=b.type||"",this.behavior=b.behavior||function(){},this.sensitivity="undefined"==typeof b.sensitivity?200:b.sensitivity,this.width="undefined"==typeof b.width?7:b.width,this.height="undefined"==typeof b.height?7:b.height,this.offsetDistance="undefined"==typeof b.offsetDistance?30:b.offsetDistance,this.offsetAngle=b.offsetAngle||0,this.opacity="undefined"==typeof b.opacity?.75:b.opacity,this.target=b.target||null,this.activated=!!b.activated,this.activatedColor=b.activatedColor||[255,255,255],this.borderRadius="undefined"==typeof b.borderRadius?100:b.borderRadius,this.borderWidth="undefined"==typeof b.borderWidth?2:b.borderWidth,this.borderStyle=b.borderStyle||"solid",this.borderColor=b.borderColor||[255,255,255],this.onConsume=b.onConsume||null,this.activationLocation=new Burner.Vector,this._force=new Burner.Vector,this.displayRange=!!b.displayRange,this.displayRange&&(this.rangeDisplay=this.createRangeDisplay()),this.displayConnector=!!b.displayConnector},k.prototype.step=function(){var a,b,c,d=!1;if(Burner.System._caches[this.type])for(c=Burner.System._caches[this.type].list,a=0,b=c.length;b>a;a++)this.sensorActive(c[a],this.sensitivity)&&(this.target=c[a],this.activationLocation.x||this.activationLocation.y||(this.activationLocation.x=this.parent.location.x,this.activationLocation.y=this.parent.location.y),this.activated=!0,this.activatedColor=this.target.color,this.displayConnector&&!this.connector&&(this.connector=Burner.System.add("Connector",{parentA:this,parentB:this.target})),this.displayConnector&&this.connector&&this.connector.parentB!==this.target&&(this.connector.parentB=this.target),d=!0);d?this.color=this.activatedColor:(this.target=null,this.activated=!1,this.state=null,this.color="transparent",this.activationLocation.x=null,this.activationLocation.y=null,this.connector&&(Burner.System.destroyItem(this.connector),this.connector=null)),this.afterStep&&this.afterStep.apply(this)},k.prototype.createRangeDisplay=function(){return Burner.System.add("RangeDisplay",{sensor:this})},k.prototype.getBehavior=function(){switch(this.behavior){case"CONSUME":return function(a,b){if(Flora.Utils.isInside(a.parent,b)){if(!(b.width>2))return a.onConsume&&!b.consumed&&(b.consumed=!0,a.onConsume.call(this,a,b)),Burner.System.destroyItem(b),void 0;b.width*=.95,a.parent[b.type+"Level"]||(a.parent[b.type+"Level"]=0),a.parent[b.type+"Level"]+=1,b.height>1&&(b.height*=.95),b.borderWidth>0&&(b.borderWidth*=.95),b.boxShadowSpread>0&&(b.boxShadowSpread*=.95)}};case"DESTROY":return function(a,b){Flora.Utils.isInside(a.parent,b)&&(Burner.System.add("ParticleSystem",{location:new Burner.Vector(b.location.x,b.location.y),lifespan:20,borderColor:b.borderColor,startColor:b.color,endColor:b.color}),Burner.System.destroyItem(b),a.onDestroy&&a.onDestroy.call(this,a,b))};case"LIKES":return function(a,b){var c=Burner.Vector.VectorSub(b.location,this.location);return c.limit(this.maxSteeringForce),c};case"COWARD":return function(a,b){var c=Burner.Vector.VectorSub(b.location,this.location);return c.mult(-.0075),c.limit(this.maxSteeringForce),c};case"AGGRESSIVE":return function(a,b){var c=Burner.Vector.VectorSub(b.location,this.location),d=c.mag();if(d<2*this.width){c.normalize();var e=d/this.maxSpeed;c.mult(e)}return c.sub(this.velocity),c.limit(this.maxSteeringForce),c};case"CURIOUS":return function(a,b){var c,d;if("running"!==a.state){var e=a.activationLocation.midpoint(b.location);c=Burner.Vector.VectorSub(e,this.location),d=c.mag(),c.normalize();var f=d/this.maxSpeed;c.mult(f),c.sub(this.velocity),.5>f&&(a.state="running")}else c=Burner.Vector.VectorSub(b.location,this.location),c.mult(-1);return c.limit(this.maxSteeringForce),c};case"EXPLORER":return function(a,b){var c=Burner.Vector.VectorSub(b.location,this.location),d=c.mag();c.normalize();var e=d/this.maxSpeed;return c.mult(-e),c.sub(this.velocity),c.limit(.05*this.maxSteeringForce),this.motorDir.x=this.velocity.x,this.motorDir.y=this.velocity.y,this.motorDir.normalize(),this.velocity.mag()>this.motorSpeed?this.motorDir.mult(-this.motorSpeed):this.motorDir.mult(this.motorSpeed),c.add(this.motorDir),c};case"LOVES":return function(a,b){var c=Burner.Vector.VectorSub(b.location,this.location),d=c.mag();if(d>this.width/2){c.normalize();var e=d/this.maxSpeed;c.mult(e);var f=Burner.Vector.VectorSub(c,this.velocity);return f.limit(.25*this.maxSteeringForce),f}this.angle=Flora.Utils.radiansToDegrees(Math.atan2(c.y,c.x))};case"ACCELERATE":return function(){return this._force.x=this.velocity.x,this._force.y=this.velocity.y,this._force.mult(.25)};case"DECELERATE":return function(){return this._force.x=this.velocity.x,this._force.y=this.velocity.y,this._force.mult(-.25)}}},k.prototype.sensorActive=function(a){var b=Burner.Vector.VectorDistance(this.location,a.location),c=this.sensitivity/2,d=a.width/2+a.boxShadowSpread;return c+d>b},z.extend(l,Burner.Item),l.prototype.init=function(a){if(!a||!a.parentA||!a.parentB)throw new Error("Connector: both parentA and parentB are required.");this.parentA=a.parentA,this.parentB=a.parentB,this.zIndex=a.zIndex||0,this.borderStyle="undefined"==typeof a.borderStyle?"dotted":a.borderStyle,this.borderColor="undefined"==typeof a.borderColor?[150,150,150]:a.borderColor,this.borderWidth=1,this.borderRadius=0,this.height=0,this.color="transparent"},l.prototype.step=function(){var a=this.parentA.location,b=this.parentB.location;this.width=Math.floor(Burner.Vector.VectorSub(this.parentA.location,this.parentB.location).mag()),this.location=Burner.Vector.VectorAdd(this.parentA.location,this.parentB.location).div(2),this.angle=z.radiansToDegrees(Math.atan2(b.y-a.y,b.x-a.x))
},z.extend(m,Burner.Item),m.prototype.init=function(a){var b=a||{};this.color=b.color||[200,200,200],this.borderRadius="undefined"==typeof b.borderRadius?100:b.borderRadius,this.borderWidth="undefined"==typeof b.borderWidth?2:b.borderWidth,this.borderStyle=b.borderStyle||"solid",this.borderColor=b.borderColor||[60,60,60],this.isStatic=!0},z.extend(n,h),n.prototype.init=function(a){var b=a||{};n._superClass.prototype.init.call(this,b),this.width="undefined"==typeof b.width?20:b.width,this.height="undefined"==typeof b.height?20:b.height,this.lifespan="undefined"==typeof b.lifespan?50:b.lifespan,this.life=b.life||0,this.fade="undefined"==typeof b.fade?!0:b.fade,this.shrink="undefined"==typeof b.shrink?!0:b.shrink,this.checkWorldEdges=!!b.checkWorldEdges,this.maxSpeed="undefined"==typeof b.maxSpeed?4:b.maxSpeed,this.zIndex="undefined"==typeof b.zIndex?1:b.zIndex,this.color=b.color||[200,200,200],this.borderWidth="undefined"==typeof b.borderWidth?this.width/4:b.borderWidth,this.borderStyle=b.borderStyle||"none",this.borderColor=b.borderColor||"transparent",this.borderRadius="undefined"==typeof b.borderRadius?100:b.borderRadius,this.boxShadowSpread="undefined"==typeof b.boxShadowSpread?this.width/4:b.boxShadowSpread,this.boxShadowColor=b.boxShadowColor||"transparent",b.acceleration||(this.acceleration=new Burner.Vector(1,1),this.acceleration.normalize(),this.acceleration.mult(this.maxSpeed?this.maxSpeed:3),this.acceleration.rotate(z.getRandomNumber(0,2*Math.PI,!0))),b.velocity||(this.velocity=new Burner.Vector),this.initWidth=this.width,this.initHeight=this.height},n.prototype.applyAdditionalForces=function(){this.fade&&(this.opacity=z.map(this.life,0,this.lifespan,1,0)),this.shrink&&(this.width=z.map(this.life,0,this.lifespan,this.initWidth,0),this.height=z.map(this.life,0,this.lifespan,this.initHeight,0))},z.extend(o,h),o.prototype.init=function(a){var b=a||{};o._superClass.prototype.init.call(this,b),this.isStatic="undefined"==typeof b.isStatic?!0:b.isStatic,this.lifespan="undefined"==typeof b.lifespan?-1:b.lifespan,this.life=b.life||-1,this.width=b.width||0,this.height=b.height||0,this.color=b.color||[255,255,255],this.borderWidth=b.borderWidth||0,this.borderStyle=b.borderStyle||"none",this.borderColor=b.borderColor||"transparent",this.borderRadius=b.borderRadius||0,this.burst="undefined"==typeof b.burst?1:b.burst,this.burstRate="undefined"==typeof b.burstRate?4:b.burstRate,this.emitRadius="undefined"==typeof b.emitRadius?3:b.emitRadius,this.startColor=b.startColor||[255,255,255],this.endColor=b.endColor||[255,0,0],this.particleOptions=b.particleOptions||{width:15,height:15,lifespan:50,borderRadius:100,checkWorldEdges:!1,acceleration:null,velocity:null,location:null,maxSpeed:3,fade:!0,shrink:!0},this.particleOptions.acceleration&&(this.initParticleAcceleration=new Burner.Vector(this.particleOptions.acceleration.x,this.particleOptions.acceleration.y));var c=new d;c.addColor({min:12,max:24,startColor:this.startColor,endColor:this.endColor}),this.clock=0,this.beforeStep=function(){var a,b,d=this.initParticleAcceleration;if(this.life<this.lifespan)this.life+=1;else if(-1!==this.lifespan)return Burner.System.destroyItem(this),void 0;if(0===this.clock%this.burstRate){a=this.location.clone(),b=new Burner.Vector(1,1),b.normalize(),b.mult(this.emitRadius),b.rotate(z.getRandomNumber(0,2*Math.PI,!0)),a.add(b);for(var e=0;e<this.burst;e++)this.particleOptions.world=this.world,this.particleOptions.life=0,this.particleOptions.color=c.getColor(),this.particleOptions.borderStyle="solid",this.particleOptions.borderColor=c.getColor(),this.particleOptions.boxShadowColor=c.getColor(),d&&(this.particleOptions.acceleration=new Burner.Vector(d.x,d.y)),this.particleOptions.location=a,Burner.System.add("Particle",this.particleOptions)}this.clock++}},z.extend(p,h),p.prototype.init=function(a){var b=a||{};this.initialLocation=b.initialLocation||new Burner.Vector(this.world.bounds[1]/2,this.world.bounds[2]/2),this.lastLocation=new Burner.Vector,this.amplitude=b.amplitude||new Burner.Vector(this.world.bounds[1]/2-this.width,this.world.bounds[2]/2-this.height),this.acceleration=b.acceleration||new Burner.Vector(.01,0),this.aVelocity=b.aVelocity||new Burner.Vector,this.isStatic=!!b.isStatic,this.isPerlin=!!b.isPerlin,this.perlinSpeed="undefined"==typeof b.perlinSpeed?.005:b.perlinSpeed,this.perlinTime=b.perlinTime||0,this.perlinAccelLow="undefined"==typeof b.perlinAccelLow?-2:b.perlinAccelLow,this.perlinAccelHigh="undefined"==typeof b.perlinAccelHigh?2:b.perlinAccelHigh,this.perlinOffsetX="undefined"==typeof b.perlinOffsetX?1e4*Math.random():b.perlinOffsetX,this.perlinOffsetY="undefined"==typeof b.perlinOffsetY?1e4*Math.random():b.perlinOffsetY,this.width="undefined"==typeof b.width?20:b.width,this.height="undefined"==typeof b.height?20:b.height,this.color=b.color||[200,100,0],this.borderWidth=b.borderWidth||0,this.borderStyle=b.borderStyle||"solid",this.borderColor=b.borderColor||[255,150,50],this.borderRadius="undefined"==typeof b.borderRadius?100:b.borderRadius,this.boxShadowSpread=b.boxShadowSpread||0,this.boxShadowColor=b.boxShadowColor||[200,100,0]},p.prototype.step=function(){var a,b=this.world;this.beforeStep&&this.beforeStep.apply(this),this.isStatic||this.isPressed||(this.isPerlin?(this.perlinTime+=this.perlinSpeed,this.aVelocity.x=z.map(A.noise(this.perlinTime+this.perlinOffsetX,0,.1),-1,1,this.perlinAccelLow,this.perlinAccelHigh),this.aVelocity.y=z.map(A.noise(0,this.perlinTime+this.perlinOffsetY,.1),-1,1,this.perlinAccelLow,this.perlinAccelHigh)):this.aVelocity.add(this.acceleration),this.parent&&(this.initialLocation.x=this.parent.location.x,this.initialLocation.y=this.parent.location.y),this.location.x=this.initialLocation.x+Math.sin(this.aVelocity.x)*this.amplitude.x,this.location.y=this.initialLocation.y+Math.sin(this.aVelocity.y)*this.amplitude.y,this.pointToDirection&&(a=Burner.Vector.VectorSub(this.location,this.lastLocation),this.angle=z.radiansToDegrees(Math.atan2(a.y,a.x))),this.controlCamera&&this._checkCameraEdges(),(this.checkWorldEdges||this.wrapWorldEdges)&&this._checkWorldEdges(b),this.lifespan>0&&(this.lifespan-=1),this.afterStep&&this.afterStep.apply(this),this.pointToDirection&&(this.lastLocation.x=this.location.x,this.lastLocation.y=this.location.y))},z.extend(q,i),q.prototype.init=function(a){var b=a||{};q._superClass.prototype.init.call(this,b),this.c="undefined"==typeof b.c?1:b.c,this.mass="undefined"==typeof b.mass?50:b.mass,this.isStatic="undefined"==typeof b.isStatic?!0:b.isStatic,this.width="undefined"==typeof b.width?100:b.width,this.height="undefined"==typeof b.height?100:b.height,this.opacity="undefined"==typeof b.opacity?.75:b.opacity,this.zIndex="undefined"==typeof b.zIndex?10:b.zIndex,this.color=b.color||[105,210,231],this.borderWidth="undefined"==typeof b.borderWidth?this.width/4:b.borderWidth,this.borderStyle=b.borderStyle||"double",this.borderColor=b.borderColor||[167,219,216],this.borderRadius="undefined"==typeof b.borderRadius?100:b.borderRadius,this.boxShadowSpread="undefined"==typeof b.boxShadowSpread?this.width/8:b.boxShadowSpread,this.boxShadowColor=b.boxShadowColor||[147,199,196],this._force=new Burner.Vector,Burner.System.updateCache(this)},q.prototype.drag=function(a){var b=a.velocity.mag(),c=-1*this.c*b*b;return this._force.x=a.velocity.x,this._force.y=a.velocity.y,this._force.normalize(),this._force.mult(c),this._force},z.extend(r,h),r.prototype.init=function(a){var b=a||{};r._superClass.prototype.init.call(this,b),this.G="undefined"==typeof b.G?10:b.G,this.mass="undefined"==typeof b.mass?1e3:b.mass,this.isStatic="undefined"==typeof b.isStatic?!0:b.isStatic,this.width="undefined"==typeof b.width?100:b.width,this.height="undefined"==typeof b.height?100:b.height,this.opacity="undefined"==typeof b.opacity?.75:b.opacity,this.zIndex="undefined "==typeof b.zIndex?1:b.zIndex,this.color=b.color||[92,187,0],this.borderWidth="undefined"==typeof b.borderWidth?this.width/4:b.borderWidth,this.borderStyle=b.borderStyle||"double",this.borderColor=b.borderColor||[224,228,204],this.borderRadius="undefined"==typeof b.borderRadius?100:b.borderRadius,this.boxShadowSpread="undefined"==typeof b.boxShadowSpread?this.width/4:b.boxShadowSpread,this.boxShadowColor=b.boxShadowColor||[64,129,0],Burner.System.updateCache(this)},r.prototype.attract=function(a){var b,c,d=Burner.Vector.VectorSub(this.location,a.location);return b=d.mag(),b=z.constrain(b,a.width*a.height,this.width*this.height),d.normalize(),c=this.G*this.mass*a.mass/(b*b),d.mult(c),d},z.extend(s,h),s.prototype.init=function(a){var b=a||{};s._superClass.prototype.init.call(this,b),this.G="undefined"==typeof b.G?-10:b.G,this.mass="undefined"==typeof b.mass?1e3:b.mass,this.isStatic="undefined"==typeof b.isStatic?!0:b.isStatic,this.width="undefined"==typeof b.width?100:b.width,this.height="undefined"==typeof b.height?100:b.height,this.opacity="undefined"==typeof b.opacity?.75:b.opacity,this.zIndex="undefined"==typeof b.zIndex?10:b.zIndex,this.color=b.color||[250,105,0],this.borderWidth="undefined"==typeof b.borderWidth?this.width/4:b.borderWidth,this.borderStyle=b.borderStyle||"double",this.borderColor=b.borderColor||[224,228,204],this.borderRadius="undefined"==typeof b.borderRadius?100:b.borderRadius,this.boxShadowSpread="undefined"==typeof b.boxShadowSpread?this.width/4:b.boxShadowSpread,this.boxShadowColor=b.boxShadowColor||[250,105,0],Burner.System.updateCache(this)},s.prototype.attract=function(a){var b,c,d=Burner.Vector.VectorSub(this.location,a.location);return b=d.mag(),b=z.constrain(b,a.width*a.height,this.width*this.height),d.normalize(),c=this.G*this.mass*a.mass/(b*b),d.mult(c),d};var B,C,D,E,F,G,H={},I={},J={},K=["double","double","dotted","dashed"];for(B=0,C=x.defaultColorList.length;C>B;B++)E=x.defaultColorList[B],D=new d,D.addColor({min:20,max:200,startColor:E.startColor,endColor:E.endColor}),H[E.name]=D,I[E.name]=E.borderColor,J[E.name]=E.boxShadowColor;for(G=new c,B=0,C=K.length;C>B;B++)F=K[B],G.addBorder({min:2,max:10,style:F});z.extend(t,h),t.prototype.init=function(a){var b=a||{};this.name.toLowerCase(),t._superClass.prototype.init.call(this,b),this.mass="undefined"==typeof b.mass?50:b.mass,this.isStatic="undefined"==typeof b.isStatic?!0:b.isStatic,this.width="undefined"==typeof b.width?50:b.width,this.height="undefined"==typeof b.height?50:b.height,this.opacity="undefined"==typeof b.opacity?.75:b.opacity,this.color=b.color||H[this.type]?H[this.type].getColor():[255,255,255],this.borderWidth="undefined"==typeof b.borderWidth?this.width/z.getRandomNumber(2,8):b.borderWidth,this.borderStyle="undefined"==typeof b.borderStyle?G.getBorder():b.borderStyle,this.borderColor=b.borderColor||H[this.type]?H[this.type].getColor():[220,220,220],this.borderRadius="undefined"==typeof b.borderRadius?100:b.borderRadius,this.boxShadowSpread="undefined"==typeof b.boxShadowSpread?this.width/z.getRandomNumber(2,8):b.boxShadowSpread,this.boxShadowColor=b.boxShadowColor||J[this.type]?J[this.type]:[200,200,200],Burner.System.updateCache(this)},z.extend(u,Burner.Item),u.prototype.init=function(a){var b=a||{};this.resolution="undefined"==typeof b.resolution?50:b.resolution,this.perlinSpeed="undefined"==typeof b.perlinSpeed?.01:b.perlinSpeed,this.perlinTime="undefined"==typeof b.perlinTime?100:b.perlinTime,this.field=b.field||null,this.createMarkers=!!b.createMarkers,this.world=b.world||Burner.System.firstWorld()},u.prototype.build=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m={},n=this.world,o=Math.ceil(n.bounds[1]/parseFloat(this.resolution)),p=Math.ceil(n.bounds[2]/parseFloat(this.resolution)),q=this.perlinTime;for(a=0,b=o;b>a;a+=1){for(l=this.perlinTime,m[a]={},c=0,d=p;d>c;c+=1){if(e=a*this.resolution+this.resolution/2,f=c*this.resolution+this.resolution/2,g=z.map(A.noise(q,l,.1),0,1,0,2*Math.PI),h=Math.cos(g),i=Math.sin(g),j=new Burner.Vector(h,i),m[a][c]=j,k=z.radiansToDegrees(Math.atan2(i,h)),this.createMarkers){var r=new v({location:new Burner.Vector(e,f),scale:1,opacity:z.map(k,-360,360,.1,.75),width:this.resolution,height:this.resolution/2,field:j,angle:k,colorMode:"rgb",color:[200,100,50],borderRadius:0,zIndex:0});n.el.appendChild(r)}l+=parseFloat(this.perlinSpeed)}q+=parseFloat(this.perlinSpeed)}this.field=m},v.prototype.name="FlowFieldMarker",z.extend(w,Burner.Item),w.prototype.init=function(a){if(!a||!a.sensor)throw new Error("RangeDisplay: a sensor is required.");this.sensor=a.sensor,this.zIndex=a.zIndex||10,this.borderStyle="undefined"==typeof a.borderStyle?"dashed":a.borderStyle,this.borderDefaultColor="undefined"==typeof a.borderDefaultColor?[150,150,150]:a.borderDefaultColor,this.borderWidth=2,this.borderRadius=100,this.width=this.sensor.sensitivity,this.height=this.sensor.sensitivity,this.minOpacity=.3,this.maxOpacity=.6,this.opacity=this.minOpacity,this.color="transparent",this.maxAngularVelocity=1,this.minAngularVelocity=0},w.prototype.step=function(){this.location=this.sensor.location,Flora.Utils.map(this.sensor.parent.velocity.mag(),this.sensor.parent.minSpeed,this.sensor.parent.maxSpeed,this.maxAngularVelocity,this.minAngularVelocity),this.sensor.activated?(this.opacity=this.maxOpacity,this.borderColor=this.sensor.target.color):(this.opacity=this.minOpacity,this.borderColor=this.borderDefaultColor)},a.Config=x,a.Interface=y,a.Utils=z,a.SimplexNoise=A,a.BorderPalette=c,a.ColorPalette=d,a.ColorTable=e,a.Caption=f,a.InputMenu=g,a.Mover=h,a.Agent=i,a.Walker=j,a.Sensor=k,a.Connector=l,a.Point=m,a.Particle=n,a.ParticleSystem=o,a.Oscillator=p,a.Dragger=q,a.Attractor=r,a.Repeller=s,a.i=B,a.max=C,a.pal=D,a.color=E,a.palettes=H,a.border=F,a.borderPalette=G,a.borderColors=I,a.boxShadowColors=J,a.borderStyles=K,a.Stimulus=t,a.FlowField=u,a.FlowFieldMarker=v,a.RangeDisplay=w}({},function(){return this}());